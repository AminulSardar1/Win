<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>WinGo 30S Lottery Data</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            font-size: 28px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .main-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .main-card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 22px;
            text-align: center;
        }
        .next-period-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        .period-number {
            font-size: 16px;
            color: #667eea;
            font-weight: bold;
        }
        .countdown {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            color: white;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 28px;
            font-weight: bold;
        }
        .result-display {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff, #e8ecff);
            border-radius: 15px;
        }
        .result-item {
            text-align: center;
        }
        .result-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            font-weight: 600;
        }
        .big-number-ball {
            display: inline-block;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            line-height: 80px;
            color: white;
            font-weight: bold;
            font-size: 36px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .big-small-badge {
            font-size: 28px;
            font-weight: bold;
            padding: 10px 25px;
            border-radius: 10px;
        }
        .big-small-badge.big {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            color: white;
        }
        .big-small-badge.small {
            background: linear-gradient(135deg, #667eea, #5a67d8);
            color: white;
        }
        .prediction-card {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 2px solid #e94560;
        }
        .prediction-card h2 {
            color: #e94560;
            margin-bottom: 20px;
            font-size: 22px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .prediction-badge {
            display: inline-block;
            background: #e94560;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            margin-left: 10px;
        }
        .prediction-display {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
        }
        .prediction-item {
            text-align: center;
        }
        .prediction-label {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 10px;
            text-transform: uppercase;
            font-weight: 600;
        }
        .prediction-number-ball {
            display: inline-block;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            line-height: 80px;
            color: white;
            font-weight: bold;
            font-size: 36px;
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.5);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 5px 20px rgba(233, 69, 96, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 8px 30px rgba(233, 69, 96, 0.7); }
            100% { transform: scale(1); box-shadow: 0 5px 20px rgba(233, 69, 96, 0.5); }
        }
        .prediction-big-small {
            font-size: 28px;
            font-weight: bold;
            padding: 10px 25px;
            border-radius: 10px;
            animation: pulse 2s infinite;
        }
        .prediction-big-small.big {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            color: white;
        }
        .prediction-big-small.small {
            background: linear-gradient(135deg, #667eea, #5a67d8);
            color: white;
        }
        .prediction-color-display {
            display: flex;
            gap: 10px;
        }
        .prediction-color-dot {
            display: inline-block;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }
        .confidence-bar {
            margin-top: 20px;
            text-align: center;
        }
        .confidence-label {
            color: #aaa;
            font-size: 12px;
            margin-bottom: 5px;
        }
        .confidence-value {
            color: #e94560;
            font-size: 24px;
            font-weight: bold;
        }
        .analysis-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(233, 69, 96, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(233, 69, 96, 0.3);
        }
        .analysis-title {
            color: #e94560;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        .analysis-method {
            color: #ccc;
            font-size: 13px;
            margin-bottom: 15px;
            padding: 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
        }
        .candidates-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .candidate-item {
            text-align: center;
            padding: 10px 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        .candidate-number {
            display: inline-block;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            line-height: 45px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 5px;
        }
        .candidate-score {
            color: #aaa;
            font-size: 12px;
        }
        .color-display {
            display: flex;
            gap: 10px;
        }
        .big-color-dot {
            display: inline-block;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .history-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .history-card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background: #667eea;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-size: 14px;
        }
        td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        tr:hover {
            background: #f8f9ff;
        }
        .number-ball {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            line-height: 40px;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .color-dot {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 0 3px;
        }
        .green { background: linear-gradient(135deg, #00c853, #009624); }
        .red { background: linear-gradient(135deg, #ff5252, #d50000); }
        .violet { background: linear-gradient(135deg, #9c27b0, #7b1fa2); }
        .big-text { color: #ff6b6b; font-weight: bold; }
        .small-text { color: #667eea; font-weight: bold; }
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        .status {
            text-align: center;
            padding: 10px;
            color: white;
            font-size: 12px;
            opacity: 0.8;
        }
        .latest-period-label {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }
        @media (max-width: 600px) {
            .result-display {
                flex-direction: column;
                gap: 15px;
            }
            .big-number-ball {
                width: 60px;
                height: 60px;
                line-height: 60px;
                font-size: 28px;
            }
            .big-small-badge {
                font-size: 22px;
                padding: 8px 20px;
            }
            .big-color-dot {
                width: 40px;
                height: 40px;
            }
            th, td {
                padding: 8px 4px;
                font-size: 12px;
            }
            .number-ball {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 14px;
            }
            .color-dot {
                width: 15px;
                height: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>WinGo 30S Lottery Data</h1>
        
        <div class="main-card">
            <h2>Next Period</h2>
            <div class="next-period-row">
                <div>
                    <div class="period-number" id="nextPeriod">Loading...</div>
                </div>
                <div class="countdown" id="countdown">00:00</div>
            </div>
            
            <div class="result-display">
                <div class="result-item">
                    <div class="result-label">Number</div>
                    <div class="big-number-ball green" id="latestNumber">-</div>
                    <div class="latest-period-label" id="latestPeriodLabel">Latest Result</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Big / Small</div>
                    <div class="big-small-badge small" id="latestBigSmall">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Color</div>
                    <div class="color-display" id="latestColors">
                        <span class="big-color-dot green"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="prediction-card">
            <h2>Prediction for Next Period <span class="prediction-badge">GUESS</span></h2>
            <div class="prediction-display">
                <div class="prediction-item">
                    <div class="prediction-label">Predicted Number</div>
                    <div class="prediction-number-ball green" id="predNumber">-</div>
                </div>
                <div class="prediction-item">
                    <div class="prediction-label">Big / Small</div>
                    <div class="prediction-big-small small" id="predBigSmall">-</div>
                </div>
                <div class="prediction-item">
                    <div class="prediction-label">Color</div>
                    <div class="prediction-color-display" id="predColors">
                        <span class="prediction-color-dot green"></span>
                    </div>
                </div>
            </div>
            <div class="confidence-bar">
                <div class="confidence-label">Confidence Level</div>
                <div class="confidence-value" id="predConfidence">---%</div>
            </div>
            <div class="analysis-section">
                <div class="analysis-title">Analysis Method</div>
                <div class="analysis-method" id="analysisMethod">Loading analysis...</div>
                <div class="analysis-title">Top Candidates</div>
                <div class="candidates-row" id="topCandidates">
                    <div class="candidate-item">
                        <div class="candidate-number green">-</div>
                        <div class="candidate-score">--%</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="history-card">
            <h2>Game History</h2>
            <table>
                <thead>
                    <tr>
                        <th>Period</th>
                        <th>Number</th>
                        <th>Big/Small</th>
                        <th>Color</th>
                    </tr>
                </thead>
                <tbody id="historyBody">
                    <tr>
                        <td colspan="4" class="loading">Loading data...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="status" id="status">Last updated: --</div>
    </div>

    <script>
        let countdownInterval;
        let leftTime = 0;

        function getBallColor(number) {
            const n = parseInt(number);
            if (n === 0) return 'red';
            if (n === 5) return 'green';
            if ([1, 3, 7, 9].includes(n)) return 'green';
            return 'red';
        }

        function updateCountdown() {
            if (leftTime > 0) {
                leftTime--;
                const minutes = Math.floor(leftTime / 60);
                const seconds = leftTime % 60;
                document.getElementById('countdown').textContent = 
                    `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                
                if (leftTime === 0) {
                    setTimeout(fetchData, 2000);
                }
            }
        }

        function renderColors(colors) {
            return colors.map(color => 
                `<span class="color-dot ${color.toLowerCase()}"></span>`
            ).join('');
        }

        function renderBigColors(colors) {
            return colors.map(color => 
                `<span class="big-color-dot ${color.toLowerCase()}"></span>`
            ).join('');
        }

        function renderPredictionColors(colors) {
            return colors.map(color => 
                `<span class="prediction-color-dot ${color.toLowerCase()}"></span>`
            ).join('');
        }

        function fetchData() {
            fetch('/api/data')
                .then(response => response.json())
                .then(data => {
                    if (data.next_period) {
                        document.getElementById('nextPeriod').textContent = 
                            `Period: ${data.next_period.issueNumber}`;
                        leftTime = data.next_period.leftTime || 0;
                    }

                    if (data.prediction) {
                        const pred = data.prediction;
                        
                        const predNumberBall = document.getElementById('predNumber');
                        predNumberBall.textContent = pred.number;
                        predNumberBall.className = `prediction-number-ball ${getBallColor(pred.number)}`;
                        
                        const predBigSmall = document.getElementById('predBigSmall');
                        predBigSmall.textContent = pred.big_small;
                        predBigSmall.className = `prediction-big-small ${pred.big_small.toLowerCase()}`;
                        
                        document.getElementById('predColors').innerHTML = renderPredictionColors(pred.colors);
                        
                        document.getElementById('predConfidence').textContent = `${pred.confidence}%`;
                        
                        if (pred.analysis) {
                            document.getElementById('analysisMethod').textContent = 
                                pred.analysis.method || 'Statistical analysis';
                            
                            if (pred.analysis.top_candidates && pred.analysis.top_candidates.length > 0) {
                                document.getElementById('topCandidates').innerHTML = 
                                    pred.analysis.top_candidates.map((c, idx) => `
                                        <div class="candidate-item">
                                            <div class="candidate-number ${getBallColor(c.number)}">${c.number}</div>
                                            <div class="candidate-score">${c.score}%</div>
                                        </div>
                                    `).join('');
                            }
                        }
                    }

                    if (data.history && data.history.length > 0) {
                        const latest = data.history[0];
                        
                        const numberBall = document.getElementById('latestNumber');
                        numberBall.textContent = latest.number;
                        numberBall.className = `big-number-ball ${getBallColor(latest.number)}`;
                        
                        const bigSmallBadge = document.getElementById('latestBigSmall');
                        bigSmallBadge.textContent = latest.big_small;
                        bigSmallBadge.className = `big-small-badge ${latest.big_small.toLowerCase()}`;
                        
                        document.getElementById('latestColors').innerHTML = renderBigColors(latest.colors);
                        
                        document.getElementById('latestPeriodLabel').textContent = `Period: ${latest.period}`;

                        const tbody = document.getElementById('historyBody');
                        tbody.innerHTML = data.history.map(item => `
                            <tr>
                                <td>${item.period}</td>
                                <td>
                                    <span class="number-ball ${getBallColor(item.number)}">
                                        ${item.number}
                                    </span>
                                </td>
                                <td class="${item.big_small.toLowerCase()}-text">${item.big_small}</td>
                                <td>${renderColors(item.colors)}</td>
                            </tr>
                        `).join('');
                    } else {
                        document.getElementById('historyBody').innerHTML = 
                            '<tr><td colspan="4">No data available</td></tr>';
                    }

                    document.getElementById('status').textContent = 
                        `Last updated: ${new Date().toLocaleTimeString()}`;
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                    document.getElementById('status').textContent = 
                        `Error: ${error.message}`;
                });
        }

        if (countdownInterval) {
            clearInterval(countdownInterval);
        }
        countdownInterval = setInterval(updateCountdown, 1000);

        fetchData();
        setInterval(fetchData, 30000);
    </script>
</body>
</html>
